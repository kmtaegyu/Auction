// 서버센트 이벤트(SSE) 모듈을 가져옵니다.
const SSE = require('sse');

// SSE 기능을 초기화하는 함수를 내보냅니다.
module.exports = (server) => {
  // 서버를 기반으로 SSE 객체를 생성합니다.
  const sse = new SSE(server);

  // 클라이언트와의 SSE 연결이 이루어졌을 때의 처리를 정의합니다.
  sse.on('connection', (client) => {
    // 클라이언트와의 연결이 이루어지면 매 초마다 현재 시간 정보를 클라이언트로 전송합니다.
    setInterval(() => {
      client.send(Date.now().toString()); // 현재 시간 정보를 문자열로 변환하여 클라이언트로 전송합니다.
    }, 1000); // 1초마다 전송
  });
};

// 코드는 서버센트 이벤트(SSE)를 통해 클라이언트에게 주기적으로 
//현재 시간을 전송하는 기능을 구현한 것입니다. 주석을 통해 자세히 설명하면 다음과 같습니다:

//1. SSE 모듈을 사용하여 서버센트 이벤트(SSE)를 처리할 수 있는 객체를 가져옵니다.
//2. 함수를 내보내며, 인자로 서버 객체를 받습니다.
//3. 서버 객체를 기반으로 SSE 객체를 생성합니다.
//4. 클라이언트와의 SSE 연결이 이루어졌을 때(connection 이벤트)의 처리를 정의합니다.
//5. 클라이언트와의 연결이 이루어지면 매 초마다 현재 시간 정보를 클라이언트로 전송합니다.
//6. setInterval 함수를 사용하여 매 초마다 현재 시간을 클라이언트로 전송하는데, 이를 통해 실시간으로 데이터를 업데이트할 수 있습니다.
//7. 현재 시간 정보는 Date.now()를 사용하여 밀리초로 얻어온 후, 문자열로 변환하여 클라이언트로 전송합니다.